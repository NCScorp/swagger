<?xml version="1.0" encoding="UTF-8"?>
<nsjusecase xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="../../vendor/nasajon/mdatransformer/schemas/nsjusecase.xsd" name="responsabilidadesfinanceiras" label="responsabilidadesfinanceiras" project="crm">
    <entity schema="crm" table="responsabilidadesfinanceiras">
        <!--
            Atenção:
            ao realizar alterações neste model, por favor conferir o arquivo 
            AppBundle/Repository/Crm/ResponsabilidadesfinanceirasRepository.php
            e fazer as devidas modificações (pois o repository foi sobrescrito)
        -->
        <fieldmodel name="responsabilidadefinanceira" datatype="guid" isid="true" column="responsabilidadefinanceira"/>
        <fieldmodel name="negocio" datatype="guid" column="negocio"/>
        <fieldmodel name="created_at" datatype="datetime" column="created_at"/>
        <fieldmodel name="created_by" datatype="json" column="created_by"/>
        <fieldmodel name="updated_at" datatype="datetime" column="updated_at"/>
        <fieldmodel name="updated_by" datatype="json" column="updated_by"/>
        <fieldmodel name="tenant" datatype="integer" column="tenant"/>
        <fieldmodel name="id_grupoempresarial" datatype="guid" column="id_grupoempresarial"/>
        <fieldmodel name="responsabilidadesfinanceirasvalores" datatype="objectlist" column="responsabilidadefinanceira" useCaseLink="crm\responsabilidadesfinanceirasvalores" entityJoinType="left" />
        <fieldmodel name="tipodivisao" datatype="integer" column="tipodivisao">
            <options>{"0":"Sem divisão","1":"Divisão igual","2":"Divisão percentual", "3":"Divisão por valor"}</options>
        </fieldmodel>
        <fieldmodel name="valorservico" datatype="float" column="valorservico" />
        <fieldmodel name="orcamento" datatype="guid" column="orcamento" />
        <fieldmodel name="geranotafiscal" datatype="boolean" column="geranotafiscal" />
        <fieldmodel name="faturamentotipo" datatype="integer" notMapped="true" />
        <fieldmodel name="descontoglobal" datatype="float" notMapped="true" />
    </entity>
    <constructors>
        <constructoritem>tenant</constructoritem>
        <constructoritem>negocio</constructoritem>
        <constructoritem>id_grupoempresarial</constructoritem>
    </constructors>
    <viewbrowser paginate="true" layout="list" target="window" label="Responsabilidade Financeira">
        <fieldsbrowser>
            <fieldbrowser entitylink="responsabilidadefinanceira" visible="false" isid="true"/>
            <fieldbrowser entitylink="orcamento" visible="false" />
            <fieldbrowser entitylink="tipodivisao" visible="false" />
            <fieldbrowser entitylink="valorservico" visible="false" />
            <fieldbrowser entitylink="negocio" visible="false" cansearch="false" fielddetaillookup="{'codigo': 'Codigo'}" />
            <fieldbrowser entitylink="geranotafiscal" visible="false" />
        </fieldsbrowser>
    </viewbrowser>
    <forms>
        <form name="default" label="Orcamentos">
            <layout>
                <headerform>
                    <row>
                        <cell controltype="textedit" colspan="6" entitylink="orcamento">
                            <validates>
                                <validate type="vnull" displaytext="O campo orcamento item não pode ser vazio."/>
                            </validates>
                        </cell>
                    </row>
                    <row>
                        <cell controltype="textedit" colspan="6" entitylink="negocio"/>
                    </row>
                    <row>
                        <cell controltype="number" colspan="6" entitylink="valorservico"/>
                    </row>
                    <row>
                        <cell label="tipo de divisao" entitylink="tipodivisao" controltype="combobox" colspan="12">
                            <validates>
                                <validate type="vnull" displaytext="O campo Tipo de divisão não pode ser vazio"/>
                            </validates>
                        </cell>
                    </row>
                    <row>
                        <cell name="responsabilidadesfinanceirasvalores" controltype="objectlist" entitylink="responsabilidadesfinanceirasvalores" colspan="12">
                        </cell>
                        <cell controltype="textedit" colspan="6" entitylink="faturamentotipo" >
                            <validates>
                                <validate type="vnull" displaytext="O campo faturamentotipo não pode ser vazio"/>
                            </validates>
                        </cell>
                    </row>
                </headerform>
            </layout>
        </form>
    </forms>
    <actions>
        <action>
            <name>retrieve</name>
        </action>
        <action>
            <name>Insert</name>
            <api>
                <name>responsabilidadeFinanceiraNovo_v5</name>
                <fromto valueapi="negocio" valueentity ="negocio"/>
                <fromto valueapi="tenant" valueentity="tenant"/>
                <fromto valueapi="created_by" valueentity ="logged_user"/>
                <fromto valueapi="id_grupoempresarial" valueentity="id_grupoempresarial"/>
                <fromto valueapi="tipodivisao" valueentity="tipodivisao"/>
                <fromto valueapi="valorservico" valueentity="valorservico"/>
                <fromto valueapi="responsabilidadesfinanceirasvalores" valueentity="responsabilidadesfinanceirasvalores"/>
                <fromto valueapi="orcamento" valueentity="orcamento"/>
                <fromto valueapi="geranotafiscal" valueentity="geranotafiscal"/>
            </api>
        </action>
        <action>
            <name>Update</name>
            <api>
                <name>responsabilidadeFinanceiraAlterar_v3</name>
                <fromto valueapi="responsabilidadefinanceira" valueentity="responsabilidadefinanceira"/>
                <fromto valueapi="tenant" valueentity="tenant"/>
                <fromto valueapi="updated_by" valueentity ="logged_user"/>
                <fromto valueapi="id_grupoempresarial" valueentity="id_grupoempresarial"/>
                <fromto valueapi="tipodivisao" valueentity ="tipodivisao"/>
                <fromto valueapi="valorservico" valueentity ="valorservico"/>
                <fromto valueapi="responsabilidadesfinanceirasvalores" valueentity="responsabilidadesfinanceirasvalores"/>
                <fromto valueapi="orcamento" valueentity="orcamento"/>
            </api>
        </action>
        <action>
            <name>Delete</name>
            <api>
                <name>responsabilidadeFinanceiraExcluir_v2</name>
                <fromto valueapi="responsabilidadefinanceira" valueentity ="responsabilidadefinanceira"/>
                <fromto valueapi="tenant" valueentity="tenant"/>
                <fromto valueapi="deleted_by" valueentity ="logged_user"/>
            </api>
        </action>
    </actions>
</nsjusecase>
