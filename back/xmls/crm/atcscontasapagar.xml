<?xml version="1.0" encoding="UTF-8"?>
<nsjusecase xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="../../vendor/nasajon/mdatransformer/schemas/nsjusecase.xsd" name="atcscontasapagar" label="atcscontasapagar" project="crm">
    <!--
        Caso seja modificado algum filtro, modificar no controller sobrescrito na função "indexAction"
    -->
    <entity schema="crm" table="atcscontasapagar">
        <fieldmodel name="atccontaapagar" datatype="guid" isid="true" column="atccontaapagar"/>
        <fieldmodel name="tenant" datatype="integer" column="tenant"/>
        <fieldmodel name="id_grupoempresarial" datatype="guid" column="grupoempresarial"/>
        <fieldmodel name="created_at" datatype="datetime" column="created_at"/>
        <fieldmodel name="created_by" datatype="json" column="created_by"/>
        <fieldmodel name="updated_at" datatype="datetime" column="updated_at"/>
        <fieldmodel name="updated_by" datatype="json" column="updated_by"/>
        <fieldmodel name="atc" datatype="guid" column="atc"/>
        <fieldmodel name="prestador" datatype="guid" column="prestador" useCaseLink="ns\fornecedores" entityJoinType="left"/>
        <fieldmodel name="servico" datatype="guid" column="servico" />
        <fieldmodel name="orcamento" datatype="guid" column="orcamento" />
        <fieldmodel name="itemprocessarcontapagar" datatype="guid" column="itemprocessarcontapagar" useCaseLink="crm\itensprocessarcontaspagar" entityJoinType="left"/>
        <fieldmodel name="descricao" datatype="string" column="descricao"/>
        <fieldmodel name="quantidade" datatype="integer" column="quantidade"/>
        <fieldmodel name="valoracordado" datatype="float" column="valoracordado"/>
        <fieldmodel name="valorpagar" datatype="float" column="valorpagar"/>
        <fieldmodel name="negociodocumento" datatype="guid" column="negociodocumento" />
        <fieldmodel name="numerodocumento" datatype="string" column="numerodocumento"/>
        <fieldmodel name="datadocumento" datatype="date" column="datadocumento"/>
    </entity>
    <constructors>
        <constructoritem>tenant</constructoritem>
        <constructoritem>id_grupoempresarial</constructoritem>
        <constructoritem>atc</constructoritem>
    </constructors>
    <viewbrowser layout="list" target="window" label="Contas a pagar">
        <filters>
            <fieldsfilters>
                <fieldfilter entitylink="prestador" maxoccurs="unbounded" visible="false">
                    <conditions>
                        <condition type="eq"/>
                    </conditions>
                </fieldfilter>
                <fieldfilter entitylink="servico" maxoccurs="unbounded" visible="false">
                    <conditions>
                        <condition type="eq"/>
                    </conditions>
                </fieldfilter>
                <fieldfilter entitylink="orcamento" maxoccurs="unbounded" visible="false">
                    <conditions>
                        <condition type="eq"/>
                    </conditions>
                </fieldfilter>
                <fieldfilter entitylink="negociodocumento" maxoccurs="unbounded" visible="false">
                    <conditions>
                        <condition type="eq"/>
                    </conditions>
                </fieldfilter>
            </fieldsfilters>
        </filters>
        <fieldsbrowser>
            <fieldbrowser entitylink="atccontaapagar" visible="true" isid="true"/>
            <fieldbrowser entitylink="atc" visible="false" cansearch="false" />
            <fieldbrowser entitylink="prestador" visible="false"  fielddetaillookup="{'nome':'Nome', 'codigo':'Código', 'descricao':'Descrição'}" />
            <fieldbrowser entitylink="servico" visible="false" />
            <fieldbrowser entitylink="orcamento" visible="false" />
            <fieldbrowser entitylink="itemprocessarcontapagar" visible="false" />
            <fieldbrowser entitylink="descricao" visible="false" />
            <fieldbrowser entitylink="quantidade" visible="false" cansearch="false" />
            <fieldbrowser entitylink="valoracordado" visible="true" cansearch="false"/>
            <fieldbrowser entitylink="valorpagar" visible="true" cansearch="false"/>
            <fieldbrowser entitylink="negociodocumento" visible="true" cansearch="false"/>
            <fieldbrowser entitylink="numerodocumento" visible="true" cansearch="false"/>
            <fieldbrowser entitylink="datadocumento" visible="true" cansearch="false"/>
        </fieldsbrowser>
    </viewbrowser>
    <forms>
        <form name="default" label="Contas a pagar">
            <layout>
            <headerform>
                <row>
                    <cell label="valorpagar" controltype="number" colspan="6" entitylink="valorpagar"/>
                    <cell label="quantidade" controltype="number" colspan="6" entitylink="quantidade"/>
                </row>
            </headerform>
            </layout>
        </form>
    </forms>
    <actions>
        <action layer="back">
            <name>retrieve</name>
        </action>
        <action layer="back">
            <name>Insert</name>
            <api>
                <name>atcscontasapagarnovo</name>
                <fromto valueapi="tenant" valueentity="tenant"/>
                <fromto valueapi="grupoempresarial" valueentity="id_grupoempresarial"/>
                <fromto valueapi="atc" valueentity="atc"/>
                <fromto valueapi="prestador" valueentity="prestador"/>
                <fromto valueapi="servico" valueentity="servico"/>
                <fromto valueapi="orcamento" valueentity="orcamento"/>
                <fromto valueapi="quantidade" valueentity="quantidade"/>
                <fromto valueapi="descricao" valueentity="descricao"/>
                <fromto valueapi="created_by" valueentity ="logged_user"/>
            </api>
        </action>
        <action>
            <name>Update</name>
            <api>
                <name>atcscontasapagaralterar</name>
                <fromto valueapi="atccontaapagar" valueentity="atccontaapagar"/>
                <fromto valueapi="tenant" valueentity="tenant"/>
                <fromto valueapi="grupoempresarial" valueentity="id_grupoempresarial"/>
                <fromto valueapi="atc" valueentity="atc"/>
                <fromto valueapi="prestador" valueentity="prestador"/>
                <fromto valueapi="servico" valueentity="servico"/>
                <fromto valueapi="negociodocumento" valueentity="negociodocumento"/>
                <fromto valueapi="numerodocumento" valueentity="numerodocumento"/>
                <fromto valueapi="datadocumento" valueentity="datadocumento"/>
                <fromto valueapi="quantidade" valueentity="quantidade"/>
                <fromto valueapi="valorpagar" valueentity="valorpagar"/>
                <fromto valueapi="updated_by" valueentity ="logged_user"/>
            </api>
        </action>
        <action layer="back">
            <name>Delete</name>
            <api>
                <name>atcscontasapagarexcluir</name>
                <fromto valueapi="atccontaapagar" valueentity="atccontaapagar"/>
                <fromto valueapi="tenant" valueentity="tenant"/>
                <fromto valueapi="grupoempresarial" valueentity="id_grupoempresarial"/>
                <fromto valueapi="deleted_by" valueentity ="logged_user"/>
            </api>
        </action>
    </actions>
</nsjusecase>
