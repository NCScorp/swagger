<?xml version="1.0" encoding="UTF-8"?>
<nsjusecase xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="../../vendor/nasajon/mdatransformer/schemas/nsjusecase.xsd" name="templatesemailadvertirprestador" label="templatesemailadvertirprestador" project="crm">
    <entity schema="crm" table="templatesemailadvertirprestador">
        <fieldmodel name="templateemailadvertirprestador" datatype="guid" isid="true" column="templateemailadvertirprestador"/>
        <fieldmodel name="estabelecimento" datatype="guid" column="estabelecimento" useCaseLink="ns\estabelecimentos" entityJoinType="left"/>
        <!-- Campo não será mais utilizado para verificar se deve enviar e-mail ou não -->
        <fieldmodel name="enviaremailaoadvertir" datatype="boolean"  column="enviar_email_ao_advertir"/>
        <fieldmodel name="responderpara" datatype="string" column="responder_para"/>
        <fieldmodel name="mensagem" datatype="string"  column="mensagem"/>
        <fieldmodel name="mostrarmotivoadvertencia" datatype="boolean"  column="mostrar_motivo_advertencia"/>
        <fieldmodel name="rodape" datatype="string"  column="rodape"/>
        <fieldmodel name="assinatura" datatype="string"  column="assinatura"/>
        <fieldmodel name="created_at" datatype="datetime"  column="created_at"/>
        <fieldmodel name="created_by" datatype="json"  column="created_by"/>
        <fieldmodel name="updated_at" datatype="datetime"  column="updated_at"/>
        <fieldmodel name="updated_by" datatype="json"  column="updated_by"/>
        <fieldmodel name="id_grupoempresarial" datatype="guid"  column="id_grupoempresarial"/>
        <fieldmodel name="tenant" datatype="integer"  column="tenant"/>
    </entity>
    <constructors>
        <constructoritem>tenant</constructoritem>
    </constructors>
    <viewbrowser label="Templates de E-mail ao Advertir um Prestador de Serviços" layout="list" paginate="true" target="builtin">
        <filters>
            <fieldsfilters>
                <fieldfilter label="Estabelecimento" visible="false" entitylink="estabelecimento">
                    <conditions>
                        <condition type="eq" />
                    </conditions>
                </fieldfilter>
            </fieldsfilters>
        </filters>
        <fieldsbrowser>
            <fieldbrowser entitylink="templateemailadvertirprestador" isid="true" visible="false"/>
            <fieldbrowser alias="estabelecimento" entitylink="estabelecimento" visible="true" cansearch="true" fielddetaillookup="{'nomefantasia': 'Nome'}"/>
            <fieldbrowser entitylink="enviaremailaoadvertir" visible="false"/>
            <fieldbrowser entitylink="responderpara" visible="false"/>
            <fieldbrowser entitylink="mensagem" visible="false"/>
            <fieldbrowser entitylink="mostrarmotivoadvertencia" visible="false"/>
            <fieldbrowser entitylink="rodape" visible="false"/>
            <fieldbrowser entitylink="assinatura" visible="false"/>
        </fieldsbrowser>
    </viewbrowser>
    <forms>
        <form name="default" label="Template de E-mail ao Advertir um Prestador de Serviços">
            <layout>
                <headerform>
                    <row>
                        <cell label="Estabelecimento" entitylink="estabelecimento" controltype="lookup" colspan="6" fielddetaillookup="{'nomefantasia':'Nome'}" amountfieldslookup="1" allowinsertlookup="true">
                            <validates>
                                <validate type="vnull" displaytext="O campo estabelecimento não pode ser vazio" />
                            </validates>
                        </cell>
                    </row>
                    <row visible="false">
                        <cell colspan="12" label="Responder para" name="responderpara" controltype="textedit" entitylink="responderpara">
                            <validates>
                                <validate type="vnull" displaytext="O campo Responder Para não pode ser vazio" />
                            </validates>
                        </cell>
                    </row>
                    <row>
                        <cell colspan="12" label="Mensagem" name="mensagem" controltype="textarea" entitylink="mensagem">
                        </cell>
                    </row>
                    <row>
                        <cell colspan="12" label="Mostrar motivo da advertência" name="mostrarmotivoadvertencia" controltype="checkbox" entitylink="mostrarmotivoadvertencia">
                        </cell>
                    </row>
                    <row >
                        <cell colspan="12" label="Rodapé" name="rodape" controltype="textarea" entitylink="rodape">
                        </cell>
                    </row>
                    <row>
                        <cell colspan="12" label="Assinatura" name="assinatura" controltype="textarea" entitylink="assinatura" >
                        </cell>
                    </row>
                </headerform>
            </layout>
        </form>
    </forms>
    <actions>
        <action form="default">
            <name>retrieve</name>
        </action>
        <action form="default" successMsg="O Template de E-mail ao Advertir um Prestador de Serviços foi criado com sucesso!" failMsg="Ocorreu um erro ao criar o Template de E-mail ao Advertir um Prestador de Serviços!">
            <name>Insert</name>
            <api>
                <name>templateEmailAdvertirPrestadorNovo</name>
                <fromto valueapi="estabelecimento" valueentity="estabelecimento"/>
                <fromto valueapi="enviaremailaoadvertir" valueentity="enviaremailaoadvertir"/>
                <fromto valueapi="responderpara" valueentity="responderpara"/>
                <fromto valueapi="mensagem" valueentity="mensagem"/>
                <fromto valueapi="mostrarmotivoadvertencia" valueentity="mostrarmotivoadvertencia"/>
                <fromto valueapi="rodape" valueentity="rodape"/>
                <fromto valueapi="assinatura" valueentity="assinatura"/>
                <fromto valueapi="created_by" valueentity="logged_user"/>
                <fromto valueapi="id_grupoempresarial" valueentity="id_grupoempresarial"/>
                <fromto valueapi="tenant" valueentity="tenant"/>
            </api>
        </action>
        <action form="default" successMsg="O Template de E-mail ao Advertir um Prestador de Serviços foi editado com sucesso!" failMsg="Ocorreu um erro ao editar o Template de E-mail ao Advertir um Prestador de Serviços!">
            <name>Update</name>
            <api>
                <name>templateEmailAdvertirPrestadorAlterar</name>
                <fromto valueapi="templateemailadvertirprestador" valueentity="templateemailadvertirprestador"/>
                <fromto valueapi="estabelecimento" valueentity="estabelecimento"/>
                <fromto valueapi="enviaremailaoadvertir" valueentity="enviaremailaoadvertir"/>
                <fromto valueapi="responderpara" valueentity="responderpara"/>
                <fromto valueapi="mensagem" valueentity="mensagem"/>
                <fromto valueapi="mostrarmotivoadvertencia" valueentity="mostrarmotivoadvertencia"/>
                <fromto valueapi="rodape" valueentity="rodape"/>
                <fromto valueapi="assinatura" valueentity="assinatura"/>
                <fromto valueapi="updated_by" valueentity="logged_user"/>
                <fromto valueapi="id_grupoempresarial" valueentity="id_grupoempresarial"/>
                <fromto valueapi="tenant" valueentity="tenant"/>
            </api>
        </action>
        <action successMsg="O Template de E-mail ao Advertir um Prestador de Serviços foi excluído com sucesso!" failMsg="Ocorreu um erro ao excluir o Template de E-mail ao Advertir um Prestador de Serviços!">
            <name>Delete</name>
            <api>
                <name>templateEmailAdvertirPrestadorExcluir</name>
                <fromto valueapi="templateemailadvertirprestador" valueentity="templateemailadvertirprestador"/>
                <fromto valueapi="tenant" valueentity="tenant"/>
            </api> 
        </action>
    </actions>
</nsjusecase>
