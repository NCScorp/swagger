<?xml version="1.0" encoding="UTF-8"?>
<nsjusecase xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="../../vendor/nasajon/mdatransformer/schemas/nsjusecase.xsd" name="atcsfollowups" label="atcsfollowups" project="crm">
  <entity schema="crm" table="vw_atcsfollowups">
    <fieldmodel name="negociofollowup" datatype="guid" isid="true" column="negociofollowup"/>
    <fieldmodel name="negocio" datatype="guid" column="negocio" useCaseLink="crm\atcs" entityJoinType="left"/>
    <fieldmodel name="realizadoem" datatype="datetime" column="realizadoem"/>
    <fieldmodel name="realizadoemdata" datatype="date" notMapped="true"/>
    <fieldmodel name="realizadoemhora" datatype="time" notMapped="true"/>
    <fieldmodel name="created_at" datatype="datetime" column="created_at"/>
    <fieldmodel name="created_by" datatype="json" column="created_by"/>
    <fieldmodel name="historico" datatype="string" column="historico"/>
    <fieldmodel name="receptor" datatype="string" column="receptor"/>
    <fieldmodel name="meiocomunicacao" datatype="integer" column="meiocomunicacao">
      <options>{"1":"Telefone","2":"Email", "3":"Pessoalmente", "4":"Outro"}</options>
    </fieldmodel>
    <fieldmodel name="tenant" datatype="integer" column="tenant"/>
    <fieldmodel name="ativo" datatype="boolean" column="ativo"/>
    <fieldmodel name="figuracontato" datatype="integer" column="figuracontato">
      <options>{"1":"Cliente","2":"Prestador", "3":"Seguradora", "4":"Colaborador", "5":"Responsável", "6":"Outro"}</options>
    </fieldmodel>
    <fieldmodel name="id_grupoempresarial" datatype="guid" column="id_grupoempresarial"/>
    <fieldmodel name="negociofollowupanexo" datatype="objectlist" column="negociofollowup" useCaseLink="crm\atcsfollowupsanexos" entityJoinType="left" />
    <fieldmodel name="totalanexos" datatype="integer" column="totalanexos"/>
    <fieldmodel name="historicopadrao" datatype="guid" notMapped="true" useCaseLink="crm\historicospadrao" />
  </entity>
  <constructors>
      <constructoritem>negocio</constructoritem>
      <constructoritem>tenant</constructoritem>
      <constructoritem>id_grupoempresarial</constructoritem>
  </constructors>
  <viewbrowser paginate="true" layout="list" target="builtin">
    <!-- <filters>
      <fieldsfilters>
        <fieldfilter label="Atendente" entitylink="created_by" maxoccurs="1" visible="true">
          <conditions>
            <condition type="eq"/>
          </conditions>
        </fieldfilter>
      </fieldsfilters>
    </filters> -->
    <fieldsbrowser>
        <fieldbrowser entitylink="negociofollowup" visible="true" isid="true"/>
        <fieldbrowser entitylink="negocio" visible="false"/>
        <fieldbrowser entitylink="realizadoem" visible="true"/>
        <fieldbrowser entitylink="realizadoemdata" visible="true"/>
        <fieldbrowser entitylink="realizadoemhora" visible="true"/>
        <fieldbrowser entitylink="created_at" visible="true"/>
        <fieldbrowser entitylink="created_by" visible="true"/>
        <fieldbrowser entitylink="historico" visible="true"/>
        <fieldbrowser entitylink="receptor" visible="true"/>
        <fieldbrowser entitylink="meiocomunicacao" visible="true"/>
        <fieldbrowser entitylink="tenant" visible="true"/>
        <fieldbrowser entitylink="ativo" visible="true"/>
        <fieldbrowser entitylink="figuracontato" visible="true"/>
        <fieldbrowser entitylink="totalanexos" visible="true"/>
    </fieldsbrowser>
  </viewbrowser>
  <forms>
      <form name="default">
        <layout>
            <headerform>
                <row>
                  <cell label="Origem do contato" entitylink="figuracontato" controltype="combobox" colspan="12">
                    <validates>
                      <validate type="vnull" displaytext="O campo não pode ser vazio"/>
                    </validates>
                  </cell>
                </row>
                <row>
                  <cell label="Ativo" entitylink="ativo" controltype="checkbox" colspan="12"></cell>
                </row>
                <row>
                  <cell label="Meio de Comunicação" entitylink="meiocomunicacao" controltype="combobox" colspan="12">
                    <validates>
                      <validate type="vnull" displaytext="O campo não pode ser vazio"/>
                    </validates>
                  </cell>
                </row>
                <row>
                  <cell entitylink="realizadoemdata" controltype="dateinput" colspan="6">
                    <validates>
                      <validate type="vnull" displaytext="O campo não pode ser vazio"/>
                    </validates>
                  </cell>
                  <cell entitylink="realizadoemhora" controltype="timeedit" colspan="6">
                    <validates>
                      <validate type="vnull" displaytext="O campo não pode ser vazio"/>
                    </validates>
                  </cell>
                </row>
                <row>
                  <cell entitylink="receptor" controltype="textedit" colspan="12" placeholder="Digite com quem foi feito o contato">
                    <validates>
                      <validate type="vnull" displaytext="O campo não pode ser vazio"/>
                    </validates>
                  </cell>
                </row>
                <row>
                  <cell controltype="lookup" label="historicopadrao" colspan="12" entitylink="historicopadrao" fielddetaillookup="{'codigo':'codigo', 'descricao':'descricao'}" amountfieldslookup="2">
                      <filter field="tipo" condition="eq" value="100"/>
                      <filter field="tipo" condition="eq" value="101"/>
                  </cell>
                </row>
                <row>
                  <cell entitylink="historico" controltype="textarea" colspan="12" placeholder="Digite as observações do atendimento">
                    <validates>
                      <validate type="vnull" displaytext="O campo não pode ser vazio"/>
                    </validates>
                  </cell>
                </row>
            </headerform>
        </layout>
      </form>
  </forms>
  <actions>
    <action form="default">
      <name>retrieve</name>
    </action>
    <action successMsg="O Acompanhamento foi criado com sucesso!">
      <name>Insert</name>
      <api>
        <name>atcsFollowupsNovo_v2</name>
        <fromto valueapi="negocio" valueentity="negocio" />
        <fromto valueapi="realizadoem" valueentity="realizadoem" />
        <fromto valueapi="receptor" valueentity="receptor" />
        <fromto valueapi="historico" valueentity="historico" />
        <fromto valueapi="created_by" valueentity="logged_user" />
        <fromto valueapi="meiocomunicacao" valueentity="meiocomunicacao" />
        <fromto valueapi="tenant" valueentity="tenant" />
        <fromto valueapi="ativo" valueentity="ativo" />
        <fromto valueapi="figuracontato" valueentity="figuracontato" />
        <fromto valueapi="id_grupoempresarial" valueentity="id_grupoempresarial"/>
      </api>
    </action>
  </actions>
</nsjusecase>