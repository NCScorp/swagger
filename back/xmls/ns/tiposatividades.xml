<?xml version="1.0" encoding="UTF-8"?>
<nsjusecase xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="../../vendor/nasajon/mdatransformer/schemas/nsjusecase.xsd" name="tiposatividades" label="tiposatividades" project="ns">
    <entity schema="ns" table="tiposatividades">
        <fieldmodel name="tipoatividade" datatype="guid" isid="true" column="tipoatividade"/>
        <fieldmodel name="nome" datatype="string"  column="nome"/>
        <fieldmodel name="descricao" datatype="string"  column="descricao"/>
        <fieldmodel name="tenant" datatype="integer"  column="tenant"/>
        <fieldmodel name="created_at" datatype="datetime"  column="created_at"/>
        <fieldmodel name="created_by" datatype="json"  column="created_by"/>
        <fieldmodel name="updated_at" datatype="datetime"  column="updated_at"/>
        <fieldmodel name="updated_by" datatype="json"  column="updated_by"/>
        <fieldmodel name="cnaes" datatype="objectlist" column="tipoatividade" useCaseLink="ns\cnaestiposatividades" entityJoinType="left"/>
        <fieldmodel name="tipo" datatype="integer" column="tipo">
          <options> {"0":"Outros","1":"Seguradora"} </options>
        </fieldmodel>
        <fieldmodel name="id_grupoempresarial" datatype="guid" column="id_grupoempresarial"/>
    </entity>
    <constructors>
      <constructoritem required="true">tenant</constructoritem>
      <constructoritem required="true">id_grupoempresarial</constructoritem>
    </constructors>
    <viewbrowser label="Tipos de Atividades" layout="list" paginate="true" target="builtin">
        <fieldsbrowser>
            <fieldbrowser entitylink="tipoatividade" isid="true" visible="false"/>
            <fieldbrowser alias="Nome" entitylink="nome" visible="true" indefaultorder="true" cansearch="true"/>
            <fieldbrowser alias="Descrição" entitylink="descricao" visible="false" cansearch="false"/>
            <fieldbrowser alias="Tipo" entitylink="tipo" visible="false" cansearch="true"/>
        </fieldsbrowser>
    </viewbrowser>
    <forms>
      <form name="default" label="Cadastro de Tipo de Atividade">
          <layout>
              <headerform>
                  <row>
                    <cell name="nome" controltype="textedit" label="Nome" colspan="12" entitylink="nome">
                      <validates>
                        <validate type="vnull" displaytext="O campo nome não pode ser vazio"></validate>
                      </validates>
                    </cell>
                   </row>                
                   <row>
                    <cell entitylink="tipo" controltype="combobox" label="Tipo" colspan="4">
                      <validates>
                        <validate type="vnull" displaytext="O campo não pode estar vazio" />
                      </validates>
                    </cell> 
                      <cell name="descricao" controltype="textedit" label="Descrição" colspan="12" entitylink="descricao"/>
                  </row> 
                  <row> 
                    <cell>
                      <groupbox>
                        <caption text="CNAEs"></caption>
                        <row>
                          <cell colspan="12" label="CNAEs" name="cnaes" controltype="objectlist" entitylink="cnaes" />
                        </row>
                      </groupbox>
                    </cell>
                  </row> 
              </headerform>            
          </layout>
      </form>
    </forms>
    <actions>
        <action>
          <name>retrieve</name>
        </action>
        <action successMsg="O Tipo de Atividade foi criado com sucesso!" failMsg="Ocorreu um erro ao criar o Tipo de Atividade!">
            <name>Insert</name>
            <api>
                <name>TipoAtividadeNovo_v3</name>
                <fromto valueapi="nome" valueentity="nome"/>
                <fromto valueapi="descricao" valueentity="descricao"/>
                <fromto valueapi="created_by" valueentity="logged_user"/>
                <fromto valueapi="tenant" valueentity="tenant"/>
                <fromto valueapi="cnaes" valueentity="cnaes"/>
                <fromto valueapi="tipo" valueentity="tipo"/>
                 <fromto valueapi="id_grupoempresarial" valueentity="id_grupoempresarial" />
            </api>
        </action>
        <action successMsg="O Tipo de Atividade foi editado com sucesso!" failMsg="Ocorreu um erro ao editar o Tipo de Atividade!">
            <name>Update</name>
            <api>
                <name>TipoAtividadeAlterar_v3</name>
                <fromto valueapi="tipoatividade" valueentity="tipoatividade"/>
                <fromto valueapi="nome" valueentity="nome"/>
                <fromto valueapi="descricao" valueentity="descricao"/>
                <fromto valueapi="created_by" valueentity="logged_user"/>
                <fromto valueapi="tenant" valueentity="tenant"/>
                <fromto valueapi="cnaes" valueentity="cnaes"/>
                <fromto valueapi="tipo" valueentity="tipo"/>
                 <fromto valueapi="id_grupoempresarial" valueentity="id_grupoempresarial" />
            </api>
        </action>
    </actions>
</nsjusecase>
