{% extends '@NasajonMDABundle/Resources/js/Servicos/OrdensServico/form.html.twig' %}


{% block viewedit_header_toolbar_title -%}
    {{"{{srvcs_rdns_srvc_frm_cntrllr.context.descricao}}"}}
    #<span ng-bind="srvcs_rdns_srvc_frm_cntrllr.entity.numero"></span>
{% endblock viewedit_header_toolbar_title -%}

{% block viewedit_edit -%}
    <div class="row" ><div class="col-sm-6" >
            {% block viewedit_form_cliente %}
                <div class="form-group">
                    <label class="control-label" for="cliente">Cliente</label>
                    <mda-ui-select
                        service="NsClientes"
                        constructors="{  }"
                        opts='{ "attr" : { "ng-model" : "srvcs_rdns_srvc_frm_cntrllr.entity.cliente", "ng-disabled" : "srvcs_rdns_srvc_frm_cntrllr.entity.submitting", "ng-change" : "srvcs_rdns_srvc_frm_cntrllr.changeCliente()", "placeholder" : "",  } , "required" : true, "match" : "nome" }'
                        fields='["nome", ]'>
                    </mda-ui-select>
                    <div ng-messages="srvcs_rdns_srvc_frm_cntrllr.form.cliente.$error"  ng-if='srvcs_rdns_srvc_frm_cntrllr.form.cliente.$dirty || srvcs_rdns_srvc_frm_cntrllr.submitted'>
                        <div class="alert alert-danger" role="alert" ng-message="required">
                            <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>
                            <span class="sr-only">Erro:</span>O campo cliente não pode ser vazio.
                        </div>
                    </div>
                </div>
            {% endblock viewedit_form_cliente %}
        </div><div class="col-sm-6" >
            {% block viewedit_form_estabelecimento %}

                <div class="form-group"><label class="control-label" for="estabelecimento">Estabelecimento</label><mda-ui-select
                        service="NsEstabelecimento"
                        constructors="{  }"
                        opts='{ "attr" : { "ng-model" : "srvcs_rdns_srvc_frm_cntrllr.entity.estabelecimento", "ng-disabled" : "srvcs_rdns_srvc_frm_cntrllr.entity.submitting", "ng-change" : "srvcs_rdns_srvc_frm_cntrllr.autosave()", "placeholder" : "",  } , "required" : false, "match" : "nomefantasia" }'
                        fields='["nomefantasia", ]'
                        ></mda-ui-select></div>

            {% endblock viewedit_form_estabelecimento %}
        </div></div><div class="row" ><div class="col-sm-6" >
        {% block viewedit_form_pessoamunicipio %}
                <div class="form-group">
                    <label class="control-label" for="pessoamunicipio">Município Prestação</label>
                    <ui-select tagging ng-model="srvcs_rdns_srvc_frm_cntrllr.entity.pessoamunicipio" >
                        <ui-select-match allow-clear="false" placeholder="Selecione o Município">{{'{{srvcs_rdns_srvc_frm_cntrllr.entity.pessoamunicipio.nome}}'}}</ui-select-match>
                        <ui-select-choices repeat="option in srvcs_rdns_srvc_frm_cntrllr.cliente.pessoamunicipio | filter:$select.search">
                            <div>
                                <div ng-bind-html="srvcs_rdns_srvc_frm_cntrllr.bindPessoaMunicipio(option) | highlight: $select.search "></div>
                            </div>
                        </ui-select-choices>
                    </ui-select>
                </div>
            {% endblock viewedit_form_pessoamunicipio %}
        </div><div class="col-sm-6" >
            {% block viewedit_form_enderecocliente %}
                <div class="form-group">
                    <label class="control-label" for="enderecocliente">Endereço</label>
                    <ui-select tagging ng-model="srvcs_rdns_srvc_frm_cntrllr.entity.enderecocliente" ng-change="srvcs_rdns_srvc_frm_cntrllr.autosave()">
                        <ui-select-match allow-clear="false" placeholder="Selecione o endereço">{{'{{srvcs_rdns_srvc_frm_cntrllr.entity.enderecocliente.logradouro}}'}}</ui-select-match>
                        <ui-select-choices repeat="option in srvcs_rdns_srvc_frm_cntrllr.cliente.enderecos | filter:$select.search">
                            <div>
                                <div ng-bind-html="srvcs_rdns_srvc_frm_cntrllr.bindEndereco(option) | highlight: $select.search "></div>
                            </div>
                        </ui-select-choices>
                    </ui-select>
                </div>
            {% endblock viewedit_form_enderecocliente %}
        </div></div><div class="row" ><div class="col-sm-6" >
        {% block viewedit_form_tipoordemservico_id %}

                <div class="form-group"><label class="control-label" for="tipoordemservico_id">Tipo de Ordem de Serviços</label><mda-ui-select
                        service="ServicosTipoOrdensServico"
                        constructors="{  }"
                        opts='{ "attr" : { "ng-model" : "srvcs_rdns_srvc_frm_cntrllr.entity.tipoordemservico_id", "ng-disabled" : "srvcs_rdns_srvc_frm_cntrllr.entity.submitting", "ng-change" : "srvcs_rdns_srvc_frm_cntrllr.autosave()", "placeholder" : "",  } , "required" : false, "match" : "descricao" }'
                        fields='["descricao", ]'
                        ></mda-ui-select></div>

            {% endblock viewedit_form_tipoordemservico_id %}
        </div><div class="col-sm-6" >
            {% block viewedit_form_tipo_manutencao %}

                <div class="form-group"><label class="control-label" for="tipo_manutencao">Tipo de Manutenção</label><mda-ui-select
                        service="ServicosTipoManutencao"
                        constructors="{  }"
                        opts='{ "attr" : { "ng-model" : "srvcs_rdns_srvc_frm_cntrllr.entity.tipo_manutencao", "ng-disabled" : "srvcs_rdns_srvc_frm_cntrllr.entity.submitting", "ng-change" : "srvcs_rdns_srvc_frm_cntrllr.autosave()", "placeholder" : "",  } , "required" : false, "match" : "descricao" }'
                        fields='["descricao", ]'
                        ></mda-ui-select></div>

            {% endblock viewedit_form_tipo_manutencao %}
        </div></div><div class="row" ><div class="col-sm-6" ng-show="(srvcs_rdns_srvc_frm_cntrllr.context.horimetro==true)">
        {% block viewedit_form_horimetro %}

{#                {{ form_row(form.horimetro) }}#}


            {% endblock viewedit_form_horimetro %}
        </div><div class="col-sm-6" >
            {% block viewedit_form_ativo %}
                <div class="form-group">
                    <label class="control-label" for="ativo">Ativo</label>
                    <ui-select tagging ng-model="srvcs_rdns_srvc_frm_cntrllr.entity.ativo" ng-change="srvcs_rdns_srvc_frm_cntrllr.autosave()">
                        <ui-select-match allow-clear="false" placeholder="Selecione o Ativo">{{'{{srvcs_rdns_srvc_frm_cntrllr.entity.ativo.servico_descricao}}'}}</ui-select-match>
                        <ui-select-choices repeat="option in srvcs_rdns_srvc_frm_cntrllr.cliente.ativos | filter:$select.search">
                            <div>
                                <div ng-bind-html="srvcs_rdns_srvc_frm_cntrllr.bindAtivos(option) | highlight: $select.search "></div>
                            </div>
                        </ui-select-choices>
                    </ui-select>
                </div>
            {% endblock viewedit_form_ativo %}
        </div></div><div class="row" ><div class="col-sm-6" ng-show="(srvcs_rdns_srvc_frm_cntrllr.context.contrato==true)">
        {% block viewedit_form_contrato %}
                <div class="form-group"><label class="control-label" for="contrato">Contrato</label>
                    <ui-select tagging ng-model="srvcs_rdns_srvc_frm_cntrllr.entity.contrato" ng-change="srvcs_rdns_srvc_frm_cntrllr.autosave()" ng-disabled="(srvcs_rdns_srvc_frm_cntrllr.entity.cliente==null)" >
                        <ui-select-match allow-clear="false" placeholder="Selecione o Contrato">{{'{{srvcs_rdns_srvc_frm_cntrllr.entity.contrato.descricao}}'}}</ui-select-match>
                        <ui-select-choices repeat="option in srvcs_rdns_srvc_frm_cntrllr.cliente.contrato | filter:$select.search">
                            <div>
                                <div ng-bind-html="srvcs_rdns_srvc_frm_cntrllr.bindContrato(option) | highlight: $select.search "></div>
                            </div>
                        </ui-select-choices>
                    </ui-select>
                </div>
            {% endblock viewedit_form_contrato %}
        </div><div class="col-sm-6" ng-show="(srvcs_rdns_srvc_frm_cntrllr.context.referenciaexterna==true)">
            {% block viewedit_form_referenciaexterna %}

{#                {{ form_row(form.referenciaexterna) }}#}


            {% endblock viewedit_form_referenciaexterna %}
        </div></div><div class="row" ><div class="col-sm-12" >
        {% block viewedit_form_groupbox_vncl %}
        {% endblock viewedit_form_groupbox_vncl %}
        </div></div><div class="row" ng-show="(srvcs_rdns_srvc_frm_cntrllr.context.sintoma==true)"><div class="col-sm-6" >
        {% block viewedit_form_situacao_maquina_chamado %}

{#                {{ form_row(form.situacao_maquina_chamado) }}#}


            {% endblock viewedit_form_situacao_maquina_chamado %}
        </div><div class="col-sm-12" >
            {% block viewedit_form_sintoma %}

{#                {{ form_row(form.sintoma) }}#}


            {% endblock viewedit_form_sintoma %}
        </div></div><div class="row" ng-show="(srvcs_rdns_srvc_frm_cntrllr.context.causa==true)"><div class="col-sm-6" >
        {% block viewedit_form_situacao_maquina_chegada %}

{#                {{ form_row(form.situacao_maquina_chegada) }}#}


            {% endblock viewedit_form_situacao_maquina_chegada %}
        </div><div class="col-sm-12" >
            {% block viewedit_form_causa %}

{#                {{ form_row(form.causa) }}#}


            {% endblock viewedit_form_causa %}
        </div></div><div class="row" ng-show="(srvcs_rdns_srvc_frm_cntrllr.context.intervencao==true)"><div class="col-sm-6" >
        {% block viewedit_form_situacao_maquina_saida %}

{#                {{ form_row(form.situacao_maquina_saida) }}#}


            {% endblock viewedit_form_situacao_maquina_saida %}
        </div><div class="col-sm-12" >
            {% block viewedit_form_intervencao %}

{#                {{ form_row(form.intervencao) }}#}


            {% endblock viewedit_form_intervencao %}
        </div></div><div class="row" ><div class="col-sm-12" ><fieldset ><div class="row" >
        {% block viewedit_form_servicostecnicos %}
                            <object-list
                                entities='srvcs_rdns_srvc_frm_cntrllr.entity.servicostecnicos'
                                service="ServicosOrdensServicoItem"
                                constructors="{ 'ordemservico' : srvcs_rdns_srvc_frm_cntrllr.entity.ordemservico,  }">
                                <legend class="clearfix">
                                    <h4 class="pull-left">Serviços Técnicos</h4>
                                    <a class="btn btn-sm btn-warning pull-right" ng-click="oblistctrl.add()"><i class="el el-plus"></i> Adicionar</a>
                                </legend>
                                <p class="text-center nfound ng-scope" ng-if="(entities.length == 0)">Nenhum serviço técnico adicionado</p>
                                <div class="table-default">
                                    <table class="table table-striped table-hover table-bordered table-condensed servicos-tecnicos" ng-if="(entities.length > 0)">
                                        <thead>
                                            <tr>
                                                <th width="60%">Serviço técnico</th>
                                                <th class="text-center">Venda (h)</th>
                                                <th class="text-center">Objetivo (h)</th>
                                                <th class="compact" width="49px"></th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr ng-repeat="subentity in entities"  ng-controller="ObjectListItemCtrl as itemctrl">
                                                <td>
                                        <mda-ui-select
                                            service="ServicosServicoTecnico"
                                            constructors="{  }"
                                            opts='{ "attr" : { "ng-model" : "subentity.servicotecnico", "ng-disabled" : "subentity.submitting", "ng-change" : "itemctrl.autosave()", "placeholder" : "",  } , "required" : false, "match" : "descricao" }'
                                            fields='["descricao", ]'>
                                        </mda-ui-select>
                                        </td>
                                        <td class="text-center input-wd">
                                            {#{{ form_widget(form.servicostecnicos.vars.prototype.horascontratadas) }}#}
                                        </td>
                                        <td class="text-center input-wd">
{#                                            {{ form_widget(form.servicostecnicos.vars.prototype.horasfaturar) }}#}
                                        </td>
                                        <td class="text-center">
                                            <a class="btn btn-danger btns-acoes" ng-click="itemctrl.remove()" title="Remover"><i class="el el-remove"></i></a>
                                        </td>
                                        </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </object-list>
                        {% endblock viewedit_form_servicostecnicos %}
                    </div></fieldset></div></div><div class="row" ><div class="col-sm-12" ><fieldset ng-show="(srvcs_rdns_srvc_frm_cntrllr.context.visita!=0)"><div class="row" >
                    {% block viewedit_form_visitas %}
                            <object-list
                                entities='srvcs_rdns_srvc_frm_cntrllr.entity.visitas'
                                service="ServicosVisita"
                                ng-init="srvcs_rdns_srvc_frm_cntrllr.context.visita==1?srvcs_rdns_srvc_frm_cntrllr.addVisita(oblistctrl, srvcs_rdns_srvc_frm_cntrllr.context.visita):false"
                                constructors="{ 'ordemservico' : srvcs_rdns_srvc_frm_cntrllr.entity.ordemservico,  }"
                                >
                                <legend class="clearfix">
                                    <h4 class="pull-left">Visitas</h4>
                                    <a class="btn btn-sm btn-warning pull-right" ng-click="oblistctrl.add()" ng-show="srvcs_rdns_srvc_frm_cntrllr.context.visita==2"><i class="el el-plus"></i> Adicionar</a>
                                </legend>
                                <p class="text-center nfound ng-scope" ng-if="(entities.length == 0)">Nenhuma visita adicionada</p>
                                <div class="table-default">
                                    <table class="table table-striped table-hover table-bordered table-condensed" ng-if="(entities.length > 0)">
                                        <thead>
                                            <tr>
                                                <th width="40%">Data</th>
                                                <th class="text-center" ng-if="srvcs_rdns_srvc_frm_cntrllr.context.estimativadehoras">Inicio</th>
                                                <th class="text-center" ng-if="srvcs_rdns_srvc_frm_cntrllr.context.estimativadehoras">Término</th>
                                                <th class="compact" width="7%" ng-show="srvcs_rdns_srvc_frm_cntrllr.context.visita==2"></th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr ng-repeat="subentity in entities" ng-controller="ObjectListItemCtrl as itemctrl">
                                                <td>
{#                                                    {{ form_widget(form.visitas.vars.prototype.datavisita) }}#}
                                                </td>
                                                <td class="input-wd text-center" ng-if="srvcs_rdns_srvc_frm_cntrllr.context.estimativadehoras">
{#                                                    {{ form_widget(form.visitas.vars.prototype.hora_estimada_inicio, {'attr': { 'ui-mask':'99:99:99' }}) }}#}
                                                </td>
                                                <td class="input-wd text-center" ng-if="srvcs_rdns_srvc_frm_cntrllr.context.estimativadehoras">
{#                                                    {{ form_widget(form.visitas.vars.prototype.hora_estimada_fim, {'attr': { 'ui-mask':'99:99:99' }}) }}#}
                                                </td>
                                                <td class="text-center" ng-show="srvcs_rdns_srvc_frm_cntrllr.context.visita==2">
                                                    <a class="btns-acoes btn btn-danger btn-circle" ng-click="itemctrl.remove()" title="Remover" >
                                                        <i class="el el-remove"></i>
                                                    </a>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </object-list>

                        {% endblock viewedit_form_visitas %}
                        </fieldset>
                    <div class="row" ><div class="col-sm-12" ><fieldset ng-show="(srvcs_rdns_srvc_frm_cntrllr.context.utilizadevolviveis==true)"><div class="row" ></div></fieldset></div></div>
                    <div class="row" >
                        <fieldset ng-show="(srvcs_rdns_srvc_frm_cntrllr.context.orcamento==true)">
                            <div class="col-sm-12" ><legend><h4>Orçamento (Preencha abaixo, caso tenha sido gerado)</h4></legend></div>
                            <div class="row" ><div class="col-sm-4" >
                                    {% block viewedit_form_numero_orcamento %}
{#                                        <div ng-if="srvcs_rdns_srvc_frm_cntrllr.entity.situacao==0">{{ form_row(form.numero_orcamento) }}</div>#}
                                        <p ng-if="srvcs_rdns_srvc_frm_cntrllr.entity.situacao!=0">{{'{{srvcs_rdns_srvc_frm_cntrllr.entity.numero_orcamento}}'}}</p>
                                    {% endblock viewedit_form_numero_orcamento %}
                                </div><div class="col-sm-4" >
                                    {% block viewedit_form_responsavel_orcamento %}
{#                                        <div ng-if="srvcs_rdns_srvc_frm_cntrllr.entity.situacao==0">{{ form_row(form.responsavel_orcamento) }}</div>#}
                                        <p ng-if="srvcs_rdns_srvc_frm_cntrllr.entity.situacao!=0">{{'{{srvcs_rdns_srvc_frm_cntrllr.entity.responsavel_orcamento}}'}}</p>
                                    {% endblock viewedit_form_responsavel_orcamento %}
                                </div><div class="col-sm-4" ng-show="(srvcs_rdns_srvc_frm_cntrllr.context.assinadopor==true)">
                                    {% block viewedit_form_assinado_por %}
{#                                        <div ng-if="srvcs_rdns_srvc_frm_cntrllr.entity.situacao==0">{{ form_row(form.assinado_por) }}</div>#}
                                        <p ng-if="srvcs_rdns_srvc_frm_cntrllr.entity.situacao!=0">{{'{{srvcs_rdns_srvc_frm_cntrllr.entity.assinado_por}}'}}</p>
                                    {% endblock viewedit_form_assinado_por %}
                                </div></div>
                        </fieldset>
                    </div>

                    <div class="row" ><fieldset >
                                {% block viewedit_form_observacao %}
                                    <legend style="margin-bottom:0;"><h4>Observações</h4></legend>
{#                                    {{ form_row(form.observacao) }}#}
                                {% endblock viewedit_form_observacao %}
                        </div></fieldset></div></div>
{% endblock viewedit_edit -%}
