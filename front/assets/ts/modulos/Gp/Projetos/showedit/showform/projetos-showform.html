<div class="custom-form-view">
  <div class="nsj-form-view">
    <div class="row">
      <div class="col-sm-12">
        <fieldset class="field-set">
          <legend>Dados do Projeto</legend>
          <div class="row row-form-view">
            <div class="col-sm-4">
              <div class="form-group clear-fix">
                <label for="codigo" class="control-label">Código</label>
                <p class="form-control-static">
                  {{ $ctrl.entity.codigo || 'Não informado' }}
                </p>
              </div>
            </div>
            <div class="col-sm-12">
              <div class="form-group clear-fix">
                <label for="nome" class="control-label">Nome</label>
                <p class="form-control-static">
                  {{ $ctrl.entity.nome || 'Não informado' }}
                </p>
              </div>
            </div>
          </div>
          <div class="row row-form-view">
            <div class="col-sm-12">
              <div class="form-group clear-fix">
                <label for="tipoprojeto" class="control-label">Tipo de Projeto</label>
                <p class="form-control-static">
                  {{ $ctrl.entity.tipoprojeto ? $ctrl.entity.tipoprojeto.codigo + ' - ' + $ctrl.entity.tipoprojeto.descricao : 'Não informado' }}
                </p>
              </div>
            </div>
          </div>
          <div class="row row-form-view">
            <div class="col-sm-6">
              <div class="form-group clear-fix">
                <label for="datainicio" class="control-label">Início</label>
                <p class="form-control-static">
                  {{ $ctrl.entity.datainicio ? ($ctrl.entity.datainicio | asDate | date: 'dd/MM/yyyy') : 'Não informado' }}
                </p>
              </div>
            </div>
            <div class="col-sm-6">
              <div class="form-group clear-fix">
                <label for="datafim" class="control-label">Fim</label>
                <p class="form-control-static">
                  {{ $ctrl.entity.datafim ? ($ctrl.entity.datafim | asDate | date: 'dd/MM/yyyy') : 'Não informado' }}
                </p>
              </div>
            </div>
          </div>
        </fieldset>
        <fieldset ng-if="$ctrl.entity.dadosAtc">
          <legend>Dados do atendimento comercial</legend>
          <div class="row row-form-view align-center">
            <div class="col-sm-4">
              <div class="form-group clear-fix">
                <label for="codigo" class="control-label">Atendimento comercial</label>
                <p class="form-control-static">
                  {{ $ctrl.entity.dadosAtc.codigo }} - {{ $ctrl.entity.dadosAtc.nome }}
                </p>
              </div>
            </div>
            <div class="col-sm-1">
              <a ui-sref="crm_atcs_full({ atc: $ctrl.entity.atc })" target="_blank">
                <i class="fas fa-external-link-alt"></i>
              </a>
              <nsj-button class="ml-30" icon="fas fa-eye"
                ng-click="$ctrl.openDocumentosNecessariosModal($ctrl.entity.dadosAtc.negociostiposdocumentosrequisitantes)">
                Documentos necessários
              </nsj-button>
            </div>
          </div>
          <div class="mt-20 row row-form-view">
            <div class="col-sm-12 form-group clearfix">
              <object-list class="object-list" entities='$ctrl.entity.dadosAtc.negociosdadosseguradoras'
                service="CrmAtcsdadosseguradoras" constructors="{ 'negocio' : $ctrl.entity.dadosAtc.negocio,  }"
                autosaveEnabled=>
                <div>
                  <div>
                    <table class="table table-striped table-hover table-condensed table-bordered">
                      <thead>
                        <tr>
                          <th>Seguradora</th>
                          <th>Telefone</th>
                          <th>Produto</th>
                          <th>Apólice</th>
                          <th>Valor</th>
                          <th>Sinistro</th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr ng-repeat="subentity in oblistctrl.entities" ng-controller="ObjectListItemCtrl as itemctrl">
                          <td>{{ subentity.seguradora.nomefantasia }} </td>
                          <td>
                            <!-- Tratando os possíveis inputs de DDI -->
                            {{ $ctrl.dadosSeguradora.respfinanceiroddi.length === 1 ?
                            ($ctrl.dadosSeguradora.respfinanceiroddi | mask: '+9' ) : ''}}
                            {{ $ctrl.dadosSeguradora.respfinanceiroddi.length === 2 ?
                            ($ctrl.dadosSeguradora.respfinanceiroddi | mask: '+99' ) : ''}}
                            {{ $ctrl.dadosSeguradora.respfinanceiroddi.length === 3 ?
                            ($ctrl.dadosSeguradora.respfinanceiroddi | mask: '+999' ) : ''}}

                            <!-- Tratando os possíveis inputs de DDD -->
                            {{ $ctrl.dadosSeguradora.respfinanceiroddd.length === 1 ?
                            ($ctrl.dadosSeguradora.respfinanceiroddd | mask: '(9)' ) : ''}}
                            {{ $ctrl.dadosSeguradora.respfinanceiroddd.length === 2 ?
                            ($ctrl.dadosSeguradora.respfinanceiroddd | mask: '(99)') : ''}}
                            {{ $ctrl.dadosSeguradora.respfinanceiroddd.length === 3 ?
                            ($ctrl.dadosSeguradora.respfinanceiroddd | mask: '(999)') : ''}}

                            <!-- Tratando os possíveis inputs de telefone -->
                            {{ $ctrl.dadosSeguradora.respfinanceirotelefone.length === 0 ? 'Não informado' : ''}}
                            {{ $ctrl.dadosSeguradora.respfinanceirotelefone.length === 8 ?
                            ($ctrl.dadosSeguradora.respfinanceirotelefone | mask: '9999-9999') : '' }}
                            {{ $ctrl.dadosSeguradora.respfinanceirotelefone.length === 9 ?
                            ($ctrl.dadosSeguradora.respfinanceirotelefone | mask: '99999-9999') : '' }}
                            {{ $ctrl.dadosSeguradora.respfinanceirotelefone.length !== 0 &&
                            $ctrl.dadosSeguradora.respfinanceirotelefone.length !== 8 &&
                            $ctrl.dadosSeguradora.respfinanceirotelefone.length !== 9 ?
                            ($ctrl.dadosSeguradora.respfinanceirotelefone) : ''
                            }}
                          </td>
                          <td>{{ subentity.produtoseguradora.nome ? subentity.produtoseguradora.nome : 'Não informado' }} </td>
                          <td> {{ subentity.apolice.nome ? subentity.apolice.nome : 'Não informado' }} </td>
                          <td>{{ subentity.apolice.valorapolice ? 'R$ ' + subentity.apolice.valorapolice : 'Não informado' }}</td>
                          <td>{{ subentity.sinistro ? subentity.sinistro : 'Não informado' }} </td>
                        </tr>
                      </tbody>
                      <tfoot ng-if="oblistctrl.entities.length == 0">
                        <tr>
                          <td colspan="15" class="state-empty">
                            <div class="empty-list">
                              <p class="text-center"> Não existem itens para mostrar nesta lista. </p>
                            </div>
                          </td>
                        </tr>
                      </tfoot>
                    </table>
                  </div>
                </div>
              </object-list>
            </div>
          </div>
          <div class="row" ng-if="$ctrl.camposCustomizados.dadosResponsavelResumido">
            <div class="col-sm-12">
              <nsj-custom-field without-legend="true" id-field="camposCustomizadosDadosResponsavel"
                ng-prop-custom_fields="$ctrl.camposCustomizados.dadosResponsavelResumido"
                ng-prop-model="$ctrl.entity.dadosAtc.camposcustomizados" mode="view">
                </nsj-custom-fields>
            </div>
          </div>
          <div class="row row-form-view">
            <div class="col-sm-12">
              <div class="form-group clear-fix">
                <label for="endereco" class="control-label">Endereço</label>
                <p class="form-control-static">
                  {{ $ctrl.entity.dadosAtc.localizacaotipologradouro.descricao }}
                  {{ $ctrl.entity.dadosAtc.localizacaorua }},
                  {{ $ctrl.entity.dadosAtc.localizacaonumero }} -
                  {{ $ctrl.entity.dadosAtc.localizacaomunicipio.nome }},
                  {{ $ctrl.entity.dadosAtc.localizacaoestado.nome }} -
                  {{ $ctrl.entity.dadosAtc.localizacaoestado.uf }},
                  {{ $ctrl.entity.dadosAtc.localizacaocep }}
                </p>
              </div>
            </div>
          </div>
        </fieldset>
      </div>
    </div>
  </div>
</div>